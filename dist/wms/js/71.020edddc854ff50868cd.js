webpackJsonp([71],{1006:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapDispatchToProps=void 0;var n=a(3),l=function(e){return e&&e.__esModule?e:{default:e}}(n),o=a(161),d=a(1069),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(d);t.mapDispatchToProps=function(e){return(0,o.bindActionCreators)((0,l.default)({},r),e)}},1069:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.handleDetaiList=t.handleRep=t.handleExport=t.handleDetailPlan=t.handleGetDetailRecord=t.handleStart=t.handleConfirmPlan=t.handleCloseOrder=t.handleCreateData=t.handleCreatePlan=t.handleGetList=t.update=void 0;var l=a(3),o=n(l),d=a(298),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(d),i=a(28),u=a(79),c=a(35),s=n(c);t.update=function(e){return{type:r.INVENTORYPLAN_UPDATE,data:e}},t.handleGetList=function(e,t){return function(a){console.log(t,333),a({type:r.INVENTORYPLAN_UPDATE,data:{tableLoading:!0}});var n=(0,o.default)({},e.searchParams);for(var l in n)"[object Object]"===Object.prototype.toString.call(n[l])&&(n[l]="productName"===l?n[l].children:n[l].value);n.initDate&&n.initDate.length&&(n.beginDate=(0,s.default)(n.initDate[0]).format("YYYY-MM-DD"),n.endDate=(0,s.default)(n.initDate[1]).format("YYYY-MM-DD")),delete n.initDate,e.searchParams=n,t?(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_GETHEADLIST_PAGE},e)).then(function(t){var n=e.searchParams,l=n.page,o=n.size;a({type:r.INVENTORYPLAN_UPDATE,data:{page:l,size:o,tableLoading:!1,total:t.result.total,selectedRowKeys:[],selectedRows:[],searchResult:t.result.list||[]}})}).catch(function(e){a({type:r.INVENTORYPLAN_FILE})}):(console.log(e,222),(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_GETCOUNTBYSTATUSSORT_NUM},e)).then(function(t){var n=t.result,l=["0","1","2","3","4"],d="",c={tab0:"",tab1:"",tab2:"",tab3:"",tab4:""};n.map(function(e){c["tab"+e.key]=e.value});for(var s=0;s<l.length;s++){for(var f=0;f<n.length;f++)if(n[f].key==l[s]&&n[f].value){d=l[s];break}if(d)break}d&&(console.log(d,77),e.searchParams.statusCode=d),(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_GETHEADLIST_PAGE},e)).then(function(t){var n=e.searchParams,l=n.page,i=n.size;a({type:r.INVENTORYPLAN_UPDATE,data:(0,o.default)({page:l,size:i,tableLoading:!1,total:t.result.total,tableActiveKey:d,selectedRowKeys:[],selectedRows:[],searchResult:t.result.list||[]},c)})}).catch(function(e){a({type:r.INVENTORYPLAN_FILE})})}).catch(function(e){a({type:r.INVENTORYPLAN_FILE})}))}},t.handleCreatePlan=function(e,t){return function(t){t({type:r.INVENTORYPLAN_UPDATE,data:{modalTableLoading:!0}}),(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_STOCKDETAILS_TPAGE},e)).then(function(e){t({type:r.INVENTORYPLAN_UPDATE,data:{modalTableLoading:!1,modalTotal:e.result.length,modalSearchResult:e.result||[]}})}).catch(function(e){t({type:r.INVENTORYPLAN_FILE})})}},t.handleCreateData=function(e,t){return function(a){(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_CREATEINVENTORYPLAN_CREATE},e)).then(function(e){t&&t(e.result)}).catch(function(e){a({type:r.INVENTORYPLAN_FILE})})}},t.handleCloseOrder=function(e,t){return function(a){(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_CANSOLEPLAN_CLOSE},e)).then(function(e){t&&t(e.result)}).catch(function(e){a({type:r.INVENTORYPLAN_FILE})})}},t.handleConfirmPlan=function(e,t){return function(a){(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_CONFIRMPLAN_DET},e)).then(function(e){t&&t(e.result)}).catch(function(e){a({type:r.INVENTORYPLAN_FILE})})}},t.handleStart=function(e,t){return function(a){(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_STARTPLAN_START},e)).then(function(e){t&&t(e.result)}).catch(function(e){a({type:r.INVENTORYPLAN_FILE})})}},t.handleGetDetailRecord=function(e){return function(t){t({type:r.INVENTORYPLAN_UPDATE,data:{deliveryTableLoading:!0}}),(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_GETTRACELIST_TPAGE},e)).then(function(e){t({type:r.INVENTORYPLAN_UPDATE,data:{deliveryTableLoading:!1,searchResultRecord:e.result||[]}})}).catch(function(e){t({type:r.INVENTORYPLAN_FILE})})}},t.handleDetailPlan=function(e,t){return function(a){a({type:r.INVENTORYPLAN_UPDATE,data:{modalTableLoading:!0}}),(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_GETITEMLIST_PAGE},e)).then(function(t){var n=e.searchParams,l=n.page,o=n.size;a({type:r.INVENTORYPLAN_UPDATE,data:{modalPage:l,modalSize:o,modalTableLoading:!1,modalTotal:t.result.total,modalSearchResult:t.result.list||[],modalSelectedRowKeys:[],modalSelectedRows:[]}})}).catch(function(e){a({type:r.INVENTORYPLAN_FILE}),t&&t()})}},t.handleExport=function(e){return function(t){t({type:r.INVENTORYPLAN_UPDATE,data:{buttonLoading:!0}});var a=u.API_INVENTORYPLAN_PLANITEMEXPORT_EXPORT;(0,i.getData)((0,o.default)({api:a},e)).then(function(e){t({type:r.INVENTORYPLAN_UPDATE,data:{buttonLoading:!1}})}).catch(function(e){t({type:r.INVENTORYPLAN_FILE})})}},t.handleRep=function(e,t){return function(a){a({type:r.INVENTORYPLAN_UPDATE,data:{modalTuttonLoading:!0}});var n=u.API_INVENTORYPLAN_REPEATINVENTORY_REP;(0,i.getData)((0,o.default)({api:n},e)).then(function(e){a({type:r.INVENTORYPLAN_UPDATE,data:{modalTuttonLoading:!1}}),t&&t()}).catch(function(e){a({type:r.INVENTORYPLAN_FILE})})}},t.handleDetaiList=function(e,t){return function(a){a({type:r.INVENTORYPLAN_UPDATE,data:{recordTableLoading:!0}}),(0,i.getData)((0,o.default)({api:u.API_INVENTORYPLAN_GETITEMPRODUCTTRACE_TPAGE},e)).then(function(e){a({type:r.INVENTORYPLAN_UPDATE,data:{recordTableLoading:!1,detailResult:e.result||[]}})}).catch(function(e){a({type:r.INVENTORYPLAN_FILE}),t&&t()})}}},903:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,o,d=a(90),r=n(d),i=a(278),u=n(i),c=a(274),s=n(c),f=a(160),p=n(f),m=a(994),h=n(m),E=a(94),y=n(E),N=a(276),P=n(N),I=a(53),T=n(I),g=a(18),A=n(g),v=a(5),L=n(v),R=a(10),_=n(R),C=a(6),D=n(C),O=a(7),b=n(O),S=a(3),k=n(S);a(91),a(279),a(275),a(80),a(164),a(59),a(277),a(54);var Y=a(0),x=n(Y),w=a(108),V=a(1006),z=a(280),U=a(79),M=(l=(0,w.connect)(function(e){return(0,k.default)({},e.inventoryPlan,{userLoation:e.userLoation})},V.mapDispatchToProps))(o=function(e){function t(){(0,L.default)(this,t);var e=(0,D.default)(this,(t.__proto__||(0,A.default)(t)).call(this));return e.handleCloseModal=function(){var t=e.props.history;t.length>1?t.goBack():window.close()},e.onChange=function(t,a,n,l){var o=e.props,d=o.handleDetailPlan,r=o.detailData,i=o.modalPage,u=o.modalSize,c=o.match.params;d(n.order?"ascend"===n.order?{searchParams:(0,k.default)({page:i,size:u},r,{isAsc:!0,columns:n.field,orderCode:c.id})}:{searchParams:(0,k.default)({page:i,size:u},r,{isAsc:!1,columns:n.field,orderCode:c.id})}:{searchParams:(0,k.default)({page:t.current,size:t.pageSize},r,{orderCode:c.id})})},e.query=function(){var t=e.props,a=t.handleDetailPlan,n=t.detailData,l=t.modalPage,o=t.modalSize,d=t.match.params,r=(0,k.default)({},n);for(var i in r)"[object Object]"===Object.prototype.toString.call(r[i])&&(r[i]=r[i].value);a({searchParams:(0,k.default)({page:l,size:o},r,{orderCode:d.id})})},e.reset=function(){var t=e.props,a=t.update,n=t.modalSize,l=t.handleDetailPlan,o=t.match.params;a({detailData:{}}),l({searchParams:{page:1,size:n,orderCode:o.id}})},e.export=function(){var t=e.props,a=t.handleExport,n=t.detailData,l=t.match.params;a({searchParams:(0,k.default)({},n,{orderCode:l.id})})},e.review=function(){var t=e.props,a=t.handleRep,n=t.match.params;a({data:{ids:t.modalSelectedRowKeys,orderCode:n.id}},function(){T.default.success("复盘开始");var t=e.props,a=t.handleDetailPlan,l=t.detailData,o=t.modalPage,d=t.modalSize,r=(0,k.default)({},l);for(var i in r)"[object Object]"===Object.prototype.toString.call(r[i])&&(r[i]=r[i].value);a({searchParams:(0,k.default)({page:o,size:d},r,{orderCode:n.id})})})},e.edit=function(t){var a=e.props,n=a.handleDetaiList,l=a.match.params,o=a.userLoation;console.log(o,111),e.setState({visible:!e.state.visible});var d={productCode:t.productCode,storeLocationCode:t.storeLocationCode,warehouseCode:o.value};n({searchParams:(0,k.default)({},d,{orderCode:l.id})})},e.handleCancel=function(){e.setState({visible:!e.state.visible})},e.state={visible:!1},e.columns1=[{title:"操作",width:150,dataIndex:"",key:"",render:function(t,a,n){return x.default.createElement("div",{className:"tableOperation"},x.default.createElement("span",{onClick:function(){return e.edit(a)}},"记录"))}},{title:"商品编码",width:150,dataIndex:"productCode",key:"productCode"},{title:"商品条码",width:100,dataIndex:"productBarCode",key:"productBarCode"},{title:"商品名称",width:150,dataIndex:"productName",key:"productName"},{title:"单位",width:100,dataIndex:"unit",key:"unit"},{title:"盘点储位",width:100,dataIndex:"storeLocationCode",key:"storeLocationCode"},{title:"库区",width:100,dataIndex:"reservoirAreaCode",key:"reservoirAreaCode"},{title:"盘点状态",width:100,dataIndex:"inventoryStatusDesc",key:"inventoryStatusDesc"},{title:"最后一次盘点数量",width:100,dataIndex:"lastInventoryQty",key:"lastInventoryQty"},{title:"最后一次盘点差异数量",width:100,dataIndex:"lastInventoryDiffQty",key:"lastInventoryDiffQty"},{title:"最后一次盘点差异金额（含税）",width:100,dataIndex:"lastInventoryAmountDiff",key:"lastInventoryAmountDiff"},{title:"最后一次盘点差异金额（不含税）",width:150,dataIndex:"lastInventoryAmountDiffNoTax",key:"lastInventoryAmountDiffNoTax"},{title:"最新操作人",width:150,dataIndex:"updateBy",key:"updateBy"},{title:"最新操作时间",width:150,dataIndex:"updateTime",key:"updateTime"}],e.columns2=[{title:"盘点数量",width:150,dataIndex:"inventoryQty",key:"inventoryQty"},{title:"盘点差异量",width:150,dataIndex:"inventoryDiffQty",key:"inventoryDiffQty"},{title:"操作人",width:100,dataIndex:"createBy",key:"createBy"},{title:"操作时间",width:150,dataIndex:"createTime",key:"createTime"},{title:"备注",width:200,dataIndex:"remark",key:"remark"}],e}return(0,b.default)(t,e),(0,_.default)(t,[{key:"componentDidMount",value:function(){this._getAsyncData()}},{key:"_getAsyncData",value:function(){var e=this.props;(0,e.handleDetailPlan)({searchParams:{size:e.modalSize,page:e.modalPage,orderCode:e.match.params.id}})}},{key:"onInputChange",value:function(e){var t=this.props,a=t.update,n=t.detailData;console.log(e),a({detailData:(0,k.default)({},n,e)})}},{key:"render",value:function(){var e=this,t=this.props,a=t.detailData,n=a.productCode,l=a.storeLocationCode,o=a.reservoirAreaCode,d=a.inventoryStatus,i=a.diffQtyRange,c=a.diffAmountRange,f=a.onlyInventoryDiff,m=a.onlyRepeatInventory,E=t.match.params,N=t.buttonLoading,I=t.modalTuttonLoading,T=t.detailResult,g=t.userLoation,A=this.props,v=A.modalTotal,L=A.modalPage,R=A.modalSize,_=A.modalTableLoading,C=A.recordTableLoading,D=A.modalSearchResult,O=A.modalSelectedRowKeys,b={total:v,showTotal:function(e,t){return"共 "+e+" 条"},showQuickJumper:!0,current:L,pageSize:R,showSizeChanger:!0,className:"pagination",pageSizeOptions:["50","100","200","500"]},S={onChange:function(t,a){(0,e.props.update)({modalSelectedRowKeys:t,modalSelectedRows:a})},modalSelectedRowKeys:O,getCheckboxProps:function(e){return{}}};return x.default.createElement("div",{className:"fullOrderDel"},x.default.createElement("span",{className:"ant-modal-close-x close",onClick:this.handleCloseModal}),x.default.createElement("h3",{style:{paddingBottom:"10px"}},"计划单号：",E.id),x.default.createElement("div",null,x.default.createElement(s.default,null,x.default.createElement(P.default,{span:8},x.default.createElement(z.CsxMultipleSearch,{dateApi:U.API_PRODUCT_GETPRODUCTKEYVALUES,label:"商品编码",searchParamsKey:"productCode",searchParams:{warehouseCode:g.value},selectItem:{data:n,key:"key",valueKey:["key","value"]},onChangeSelect:function(t){e.onInputChange({productCode:t})}})),x.default.createElement(P.default,{span:8},x.default.createElement("div",{className:"commonInput"},x.default.createElement("label",null,"储位编码："),x.default.createElement("div",{className:"box"},x.default.createElement(y.default,{value:l,onChange:function(t){e.onInputChange({storeLocationCode:t.target.value})}})))),x.default.createElement(P.default,{span:8},x.default.createElement(z.CsxMultipleSelect,{dateApi:U.API_STORAGELOCATIONS_RESERVOIRAREAS,label:"库区",selectItem:{data:o,key:"key",valueKey:["key","value"]},onChangeSelect:function(t){e.onInputChange({reservoirAreaCode:t})}})),x.default.createElement(P.default,{span:8},x.default.createElement(z.CsxSelect,{label:"状态",data:[{key:0,value:"初始"},{key:1,value:"待盘点"},{key:2,value:"已完成"},{key:3,value:"已确认"},{key:4,value:"已取消"}],selectItem:{data:d,key:"key",valueKey:"value"},onChangeSelect:function(t){e.onInputChange({inventoryStatus:t})}})),x.default.createElement(P.default,{span:8},x.default.createElement("div",{className:"commonInput"},x.default.createElement("label",null,"差异数量范围：+-"),x.default.createElement("div",{className:"box"},x.default.createElement(y.default,{value:i,onChange:function(t){e.onInputChange({diffQtyRange:t.target.value})}})))),x.default.createElement(P.default,{span:8},x.default.createElement("div",{className:"commonInput"},x.default.createElement("label",null,"差异金额范围：+-"),x.default.createElement("div",{className:"box"},x.default.createElement(y.default,{value:c,onChange:function(t){e.onInputChange({diffAmountRange:t.target.value})}})))),x.default.createElement(P.default,{span:11,offset:1},x.default.createElement(h.default,{style:{fontSize:"12px"},checked:f,onChange:function(t){e.onInputChange({onlyInventoryDiff:t.target.checked})}},"只查看盘点差异 "),x.default.createElement(h.default,{style:{fontSize:"12px"},checked:m,onChange:function(t){e.onInputChange({onlyRepeatInventory:t.target.checked})}},"只查看复盘 ")),x.default.createElement(P.default,{span:12},x.default.createElement(s.default,{type:"flex",justify:"end"},x.default.createElement(p.default,{type:"primary",style:{marginRight:"10px"},onClick:this.query},"查询"),x.default.createElement(p.default,{type:"primary",style:{marginRight:"10%"},onClick:this.reset},"重置"))),x.default.createElement(P.default,{span:24},x.default.createElement(s.default,{type:"flex",justify:"start"},x.default.createElement(p.default,{type:"primary",style:{marginRight:"10px"},onClick:this.review,loading:I},"复盘"),x.default.createElement(p.default,{type:"primary",onClick:this.export,loading:N},"导出"))))),x.default.createElement("div",{className:"table-group",style:{marginTop:"15px"}},x.default.createElement(u.default,{rowKey:function(e){return e.id},loading:_,columns:this.columns1,dataSource:D,scroll:{x:"max-content",y:400},onChange:this.onChange,pagination:b,rowSelection:S})),x.default.createElement("div",null,x.default.createElement(r.default,{title:"盘点记录",visible:this.state.visible,onCancel:this.handleCancel,footer:null,mask:!1,width:1024},x.default.createElement("div",{className:"table-group",style:{marginTop:"15px"}},x.default.createElement(u.default,{rowKey:function(e,t){return t},loading:C,columns:this.columns2,dataSource:T,scroll:{x:"max-content",y:400},pagination:!1})))))}}]),t}(Y.PureComponent))||o;t.default=M,e.exports=t.default},994:function(e,t,a){e.exports=a(1)(111)}});
//# sourceMappingURL=71.020edddc854ff50868cd.js.map