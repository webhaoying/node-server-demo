webpackJsonp([77],{1001:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.handleSignFor=t.handleShippedorders=t.handleUpdatediff=t.handleExportCyorder=t.handleCyorderPage=t.handleExportShortage=t.handleCyorDerchek=t.BBCCancelOrder=t.GetButtonPower=t.handleGetDetailPrint2=t.handleOut=t.handleUpdatePrintNum=t.handleExport=t.handleGetDzDetailRecord=t.handleGetDetailRecord=t.handleGetDetailPrint=t.handleTabDZDetail=t.handleTabDetail=t.handleGetList=t.update=void 0;var l=a(3),r=n(l),d=a(283),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(d),o=a(28),u=a(79),c=a(35),f=n(c);t.update=function(e){return{type:i.OUTWAREHOUSELISTSELL_UPDATE,data:e}},t.handleGetList=function(e,t){return function(a){a({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{tableLoading:!0}});var n=(0,r.default)({},e.searchParams,{orderType:"S"});n.planDate&&(n.planDate=(0,f.default)(n.planDate).format("YYYY-MM-DD"));for(var l in n)"[object Object]"===Object.prototype.toString.call(n[l])&&(n[l]="productName"===l?n[l].children:n[l].value);n.initDate&&n.initDate.length&&(n.createTimeStart=(0,f.default)(n.initDate[0]).format("YYYY-MM-DD"),n.createTimeEnd=(0,f.default)(n.initDate[1]).format("YYYY-MM-DD")),n.initDate2&&n.initDate2.length&&(n.sendDateStart=(0,f.default)(n.initDate2[0]).format("YYYY-MM-DD"),n.sendDateEnd=(0,f.default)(n.initDate2[1]).format("YYYY-MM-DD")),delete n.initDate2,delete n.initDate,e.searchParams=n,t?(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_PAGE},e)).then(function(t){var n=e.searchParams,l=n.page,r=n.size;a({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{page:l,size:r,tableLoading:!1,total:t.result.total,selectedRowKeys:[],selectedRows:[],searchResult:t.result.list||[]}})}).catch(function(e){a({type:i.OUTWAREHOUSELISTSELL_FILE})}):(0,o.getData)((0,r.default)({api:u.API_SHIPPED_LOADCOUNTS},e)).then(function(t){var n=t.result,l=["0","1","2","3","4","5","6","7","8","9","10"],d="",c={tab0:"",tab1:"",tab2:"",tab3:"",tab4:"",tab5:"",tab6:"",tab7:"",tab8:"",tab9:"",tab10:""};n.map(function(e){c["tab"+e.key]=e.value});for(var f=0;f<l.length;f++){for(var E=0;E<n.length;E++)if(n[E].key==l[f]&&n[E].value){d=l[f];break}if(d)break}d&&(e.searchParams.status=d),(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_PAGE},e)).then(function(t){var n=e.searchParams,l=n.page,o=n.size;a({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:(0,r.default)({page:l,size:o,tableLoading:!1,total:t.result.total,tableActiveKey:d,selectedRowKeys:[],selectedRows:[],searchResult:t.result.list||[]},c)})}).catch(function(e){a({type:i.OUTWAREHOUSELISTSELL_FILE})})}).catch(function(e){a({type:i.OUTWAREHOUSELISTSELL_FILE})})}},t.handleTabDetail=function(e){return function(t){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{deliveryTableLoading:!0}}),(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_DETAIL},e)).then(function(e){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{deliveryTableLoading:!1,modalData:e.result||{}}})}).catch(function(e){t({type:i.OUTWAREHOUSELISTSELL_FILE})})}},t.handleTabDZDetail=function(e){return function(t){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{deliveryTableLoading:!0}}),(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_S01DETAIL},e)).then(function(e){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{deliveryTableLoading:!1,modalData:e.result||{}}})}).catch(function(e){t({type:i.OUTWAREHOUSELISTSELL_FILE})})}},t.handleGetDetailPrint=function(e){return function(t){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{printLoading:!0}}),(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_PRINT},e)).then(function(e){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{printLoading:!1,printData:e.result||[]}})}).catch(function(e){t({type:i.OUTWAREHOUSELISTSELL_FILE})})}},t.handleGetDetailRecord=function(e){return function(t){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{deliveryTableLoading:!0}}),(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_SHIPPEDTRACES},e)).then(function(e){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{deliveryTableLoading:!1,searchResultRecord:e.result||[]}})}).catch(function(e){t({type:i.OUTWAREHOUSELISTSELL_FILE})})}},t.handleGetDzDetailRecord=function(e){return function(t){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{dzSplitTableLoading:!0}}),(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_S01GROUPPRODUCTDETAIL},e)).then(function(e){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{dzSplitTableLoading:!1,searchResultRecord:e.result||[]}})}).catch(function(e){t({type:i.OUTWAREHOUSELISTSELL_FILE})})}},t.handleExport=function(e,t){return function(a){var n=(0,r.default)({},e.searchParams,{orderType:"S"});n.planDate&&(n.planDate=(0,f.default)(n.planDate).format("YYYY-MM-DD"));for(var l in n)"[object Object]"===Object.prototype.toString.call(n[l])&&(n[l]=n[l].value);n.initDate&&n.initDate.length&&(n.createTimeStart=(0,f.default)(n.initDate[0]).format("YYYY-MM-DD"),n.createTimeEnd=(0,f.default)(n.initDate[1]).format("YYYY-MM-DD")),n.initDate2&&n.initDate2.length&&(n.sendDateStart=(0,f.default)(n.initDate2[0]).format("YYYY-MM-DD"),n.sendDateEnd=(0,f.default)(n.initDate2[1]).format("YYYY-MM-DD")),delete n.initDate2,delete n.initDate,e.searchParams=n,(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_EXPORT},e)).then(function(e){t&&t()}).catch(function(e){a({type:i.OUTWAREHOUSELISTSELL_FILE})})}},t.handleUpdatePrintNum=function(e,t){return function(a){(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_PRINTTIMES},e)).then(function(e){t&&t()}).catch(function(e){a({type:i.OUTWAREHOUSELISTSELL_FILE})})}},t.handleOut=function(e,t,a){return function(n){(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_SALEORDERSHIPPED},e)).then(function(e){t&&t()}).catch(function(e){n({type:i.OUTWAREHOUSELISTSELL_FILE}),a&&a()})}},t.handleGetDetailPrint2=function(e){return function(t){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{printLoading:!0}}),(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_COLLECTPICKINGPRINT},e)).then(function(e){t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{printLoading:!1,printData:e.result||[]}})}).catch(function(e){t({type:i.OUTWAREHOUSELISTSELL_FILE})})}},t.GetButtonPower=function(e){return function(t){(0,o.getData)((0,r.default)({api:u.API_GET_MENUS_PERMISSIONS_BANS},e)).then(function(e){var a=e.data;console.log(a,995);var n={};a.map(function(e){n[e.menuCode]=!0}),t({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:(0,r.default)({},n)})}).catch(function(e){t({type:i.OUTWAREHOUSELISTSELL_FILE})})}},t.BBCCancelOrder=function(e,t,a){return function(n){(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_BBC_ORDERCANCEL},e)).then(function(e){t&&t()}).catch(function(e){n({type:i.OUTWAREHOUSELISTSELL_FILE}),a&&a()})}},t.handleCyorDerchek=function(e,t,a){return function(n){(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_CYORDERCHECK},e)).then(function(e){t&&t(e)}).catch(function(e){n({type:i.OUTWAREHOUSELISTSELL_FILE}),a&&a()})}},t.handleExportShortage=function(e,t,a){return function(n){e.searchParams||(e=""),(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_EXPORTCYSHORTAGE},e)).then(function(e){t&&t()}).catch(function(e){n({type:i.OUTWAREHOUSELISTSELL_FILE}),a&&a()})}},t.handleCyorderPage=function(e,t,a){return function(n){(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_CYORDER},e)).then(function(e){n({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{detailData:e.result,oldData:e.result.items}}),t&&t()}).catch(function(e){n({type:i.OUTWAREHOUSELISTSELL_FILE}),a&&a()})}},t.handleExportCyorder=function(e,t,a){return function(n){(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_EXPORTCYORDER},e)).then(function(e){t&&t()}).catch(function(e){n({type:i.OUTWAREHOUSELISTSELL_FILE}),a&&a()})}},t.handleUpdatediff=function(e,t,a){return function(n){(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_UPDATEDIFF},e)).then(function(e){t&&t()}).catch(function(e){n({type:i.OUTWAREHOUSELISTSELL_FILE}),a&&a()})}},t.handleShippedorders=function(e,t,a){return function(n){(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_REMARK},e)).then(function(e){n({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{ReasonKeyValue:e.result}}),t&&t(e.result)}).catch(function(e){n({type:i.OUTWAREHOUSELISTSELL_FILE}),a&&a()})}},t.handleSignFor=function(e,t,a){return function(n){(0,o.getData)((0,r.default)({api:u.API_SHIPPEDORDERS_BUSINESSSIGN},e)).then(function(e){n({type:i.OUTWAREHOUSELISTSELL_UPDATE,data:{}}),t&&t(e)}).catch(function(e){n({type:i.OUTWAREHOUSELISTSELL_FILE}),a&&a()})}}},897:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,d=a(278),i=n(d),o=a(160),u=n(o),c=a(274),f=n(c),E=a(276),s=n(E),p=a(109),S=n(p),D=a(48),h=n(D),L=a(94),y=n(L),m=a(53),T=n(m),O=a(18),I=n(O),P=a(5),R=n(P),U=a(10),_=n(U),A=a(6),g=n(A),v=a(7),b=n(v),H=a(3),C=n(H),k=a(90),W=n(k);a(279),a(80),a(275),a(277),a(41),a(59),a(54),a(91);var Y=a(0),M=n(Y),w=a(108),x=a(999),N=a(162),F=W.default.confirm,G=(l=(0,w.connect)(function(e){return(0,C.default)({},e.outWarehouseListSell,{userLoation:e.userLoation})},x.mapDispatchToProps))(r=function(e){function t(){(0,R.default)(this,t);var e=(0,g.default)(this,(t.__proto__||(0,I.default)(t)).call(this));return e.detailImport=function(){var t=e.props;(0,t.handleExportCyorder)({searchParams:{orderCode:t.match.params.id}})},e.batchReview=function(){var t=e.props,a=t.handleCyorDerchek,n=t.handleExportShortage;a({data:{shippedOrderCode:t.detailData.linkOrderCode}},function(t){t.result.hasError?F({content:t.result.message,cancelText:"取消",okText:"缺货导出",onOk:function(){t.result.shortageList?n({searchParams:{shortageList:t.result.shortageList}}):T.default.error("暂无缺货导出")}}):(T.default.success(t.result.message),e._getAsyncData())})},e.handleCloseModal=function(){var t=e.props.history;t.length>1?t.goBack():window.close()},e.handleClosemodifyModal=function(){e.setState({modifyModal:!1,diffQty:""})},e.state={editAble:!0},e.columns=[{title:"操作",width:150,dataIndex:"operation",key:"operation",render:function(t,a,n){var l=a.editable,r=e.props.detailData;return console.log(r,33),console.log(l),M.default.createElement("div",{className:"tableOperation"},!l&&8!==r.status&&M.default.createElement("span",{className:"blue",onClick:function(){return e.edit(a.productCode)}},"编辑"),l&&8!==r.status&&M.default.createElement("span",{onClick:function(){return e.save(a.productCode)}},"保存"))}},{title:"商品编码",width:150,dataIndex:"productCode",key:"productCode"},{title:"商品名称",width:150,dataIndex:"productName",key:"productName"},{title:"销售单位",width:100,dataIndex:"unit",key:"unit"},{title:"出库数量",width:100,dataIndex:"planQty",key:"planQty"},{title:"签收数量",width:100,dataIndex:"signQty",key:"signQty"},{title:"差异数",width:150,dataIndex:"diffQty",key:"diffQty",render:function(t,a){var n=a.editable;return M.default.createElement(y.default,{disabled:!n,value:a.diffQty,onChange:function(t){a.diffQty=t.target.value,e.forceUpdate()}})}},{title:"差异原因",width:150,dataIndex:"remark",key:"remark",render:function(t,a){var n=a.editable,l=e.props,r=l.handleShippedorders,d=l.ReasonKeyValue;return r(),M.default.createElement(h.default,{disabled:!n,value:a.remark,style:{width:120},onChange:function(t){console.log("value is",t),console.log("record is",a),a.remark=t,e.forceUpdate(),console.log("record is 1222",a)}},d.map(function(e,t){return M.default.createElement(h.default.Option,{key:t,value:e},e)}))}},{title:"差异类型",width:100,dataIndex:"diffType",key:"diffType"},{title:"可用库存",width:100,dataIndex:"availableQty",key:"availableQty"}],e}return(0,b.default)(t,e),(0,_.default)(t,[{key:"edit",value:function(e){var t=this.props,a=t.update,n=t.oldData,l=[].concat((0,S.default)(n)),r=l.filter(function(t){return e===t.productCode})[0];r&&(r.editable=!0,a({oldData:l}))}},{key:"save",value:function(e){var t=this,a=this.props,n=a.oldData,l=a.handleUpdatediff,r=a.detailData,d=[].concat((0,S.default)(n)),i=d.filter(function(t){return e===t.productCode})[0];i&&l({data:{editable:i.editable,shippedOrderCode:r&&r.shippedOrderCode,productCode:i.productCode,diffQty:i.diffQty,checkRemark:i.remark}},function(){T.default.success("编辑成功"),t._getAsyncData()},function(){})}},{key:"componentDidMount",value:function(){this._getAsyncData();var e=this.props.GetButtonPower,t=JSON.parse(localStorage.getItem("b2bUserMenu")),a=(0,N.getNowPageId)(t,"/wms/out-warehouse/outWarehouseList/sell");console.log(a,t,444),e({urlParams:[a]})}},{key:"_getAsyncData",value:function(){var e=this.props;(0,e.handleCyorderPage)({searchParams:{orderCode:e.match.params.id}})}},{key:"render",value:function(){var e=this,t=this.props,a=t.detailData,n=t.deliveryTableLoading,l=t.outWareAuditDifferences,r={fontSize:"14px",marginBottom:"10px"},d={fontWeight:"bold"};return console.log("detailData is",a),M.default.createElement("div",{className:"fullOrderDel"},M.default.createElement("span",{className:"ant-modal-close-x close",onClick:this.handleCloseModal}),M.default.createElement("div",null,M.default.createElement("h2",null,"签收差异处理")),M.default.createElement(f.default,null,M.default.createElement(s.default,{span:12},M.default.createElement("div",{style:r},"出库单：",M.default.createElement("span",{style:d},a&&a.shippedOrderCode))),M.default.createElement(s.default,{span:12},M.default.createElement("div",{style:r},"差异单：",M.default.createElement("span",{style:d},a&&a.linkOrderCode))),M.default.createElement(s.default,{span:12},M.default.createElement("div",{style:r},"客户：",M.default.createElement("span",{style:d},a?a.customerCode+"-"+(a&&a.customerName):""))),M.default.createElement(s.default,{span:12},M.default.createElement("div",{style:r},"配送地址：",M.default.createElement("span",{style:d},a&&a.customerAddress))),M.default.createElement(s.default,{span:12},M.default.createElement("div",{style:r},"签收人：",M.default.createElement("span",{style:d},a&&a.updateBy))),M.default.createElement(s.default,{span:12},M.default.createElement("div",{style:r},"签收时间：",M.default.createElement("span",{style:d},a&&a.signDate))),M.default.createElement(s.default,{span:12},M.default.createElement("div",{style:r},"审核人：",M.default.createElement("span",{style:d},a&&a.checkBy))),M.default.createElement(s.default,{span:12},M.default.createElement("div",{style:r},"审核时间：",M.default.createElement("span",{style:d},a&&a.checkTime))),M.default.createElement(s.default,{span:12},M.default.createElement("div",{style:r},"签收图片：",a&&a.picUrl&&a.picUrl.map(function(e){return M.default.createElement("span",{key:e.indexOf(a.picUrl),style:d},M.default.createElement("a",{onClick:function(){window.open(e)}},"查看图片",e.indexOf(a.picUrl)+1))}))),M.default.createElement(s.default,{span:12},M.default.createElement("div",{style:r},"备注：",M.default.createElement("span",{style:d},a&&a.remark)))),M.default.createElement("div",null,l&&a&&7==a.status&&M.default.createElement(u.default,{type:"primary",style:{marginRight:"15px",marginTop:"20px"},onClick:this.batchReview},"审核差异"),a&&7==a.status&&M.default.createElement(u.default,{type:"primary",onClick:this.detailImport},"导出")),M.default.createElement("div",{className:"table-group",style:{marginTop:"20px"}},M.default.createElement(i.default,{rowKey:function(e,t){return t},loading:n,columns:this.columns,scroll:{x:"max-content",y:400},dataSource:a&&a.items,pagination:!1})),M.default.createElement("div",null,M.default.createElement(W.default,{title:"编辑商品差异数量",visible:this.state.modifyModal,onCancel:this.handleClosemodifyModal,mask:!1,width:777,onOk:this.save},M.default.createElement("div",null,M.default.createElement("div",{className:"commonInput"},M.default.createElement("label",null,"差异数："),M.default.createElement("div",{className:"box"},M.default.createElement(y.default,{value:this.state.diffQty?this.state.diffQty:this.state.record&&this.state.record.diffQty,onChange:function(t){e.setState({diffQty:t.target.value})}})))))))}}]),t}(Y.PureComponent))||r;t.default=G,e.exports=t.default},999:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapDispatchToProps=void 0;var n=a(3),l=function(e){return e&&e.__esModule?e:{default:e}}(n),r=a(161),d=a(1001),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(d);t.mapDispatchToProps=function(e){return(0,r.bindActionCreators)((0,l.default)({},i),e)}}});
//# sourceMappingURL=77.e555e44b278e30467428.js.map